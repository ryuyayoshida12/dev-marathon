<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>詳細情報画面</title>
    <!-- Bootstrap CSSの読み込み -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-5">
            <!-- ここにHTMLを書く -->

        <h2 class="mb-4">詳細情報画面</h2>
        <form id="customer-form">
            <div class="form-group">
                <table class="table table-striped">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col">項目</th>
                            <th scope="col">顧客情報</th>   
                        </tr>
                    </thead>
                    <tbody>
                        <!-- javascriptでデータ差し込み -->
                        <tr>
                            <th>id</th>
                            <td id="customer_id"></td>
                        </tr>
                        <tr>
                            <th>会社名</th>
                            <td id="company"></td>
                        </tr>
                        <tr>
                            <th>業界</th>
                            <td id="industry"></td>
                        </tr>
                        <tr>
                            <th>電話番号</th>
                            <td id="contact"></td>
                        </tr>
                        <tr>
                            <th>所在地</th>
                            <td id="location"></td>
                        </tr>
                        <tr>
                            <th>登録</th>
                            <td id="created_date"></td>
                        </tr>
                                                <tr>
                            <th>最終更新</th>
                            <td id="updated_date"></td>
                        </tr>
                    </tbody>
                    </table>

                    <!-- <button type="submit" class="btn btn-primary">登録</button> -->
            </div>
        </form>
    </div>

    <!-- CSS -->
    <style>
        th, td{
            text-align: center;       /* 横中央 */
            vertical-align: middle;   /* 縦中央 */
        }
    </style>  

    <!-- javascript -->
    <script type="module">
        import config from '../config.js';

        //------------- 初期画面構築 --------------
        const queryParam = window.location.search; //urlからクエリパラメータ取得
        const UrlParam = new URLSearchParams(queryParam); //URLsearchParams形式に
        const id = UrlParam.get("id"); //'id'の値を取得

        // '/customer/{customerId}'へリクエスト
        fetch(`${config.apiUrl}/customer/${id}`, {
            method: "GET",
            headers: {
                "Accept": "application/json"
            }
        }).then(response => response.json())
          .then(jsonData => {

            //一旦変数に代入
            const {
                customer_id,
                company_name, 
                industry, 
                contact, 
                location, 
                created_date, 
                updated_date
            }   = jsonData;

            //htmlにデータ差し込み
            document.getElementById("customer_id").textContent = customer_id;
            document.getElementById("company").textContent = company_name;
            document.getElementById("industry").textContent = industry;
            document.getElementById("contact").textContent = contact;
            document.getElementById("location").textContent = location;

            //日付関係は整形してから差し込み
            [
                {id: "created_date", date: created_date},
                {id: "updated_date", date: updated_date}
            ].forEach(({id, date}) => {
                document.getElementById(id).textContent = date.slice(0, 10);
            });
          })
          .catch((error) => console.error(error));

        

    </script>
    
    <!-- BootstrapのJavaScriptと依存関係のリンク -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>